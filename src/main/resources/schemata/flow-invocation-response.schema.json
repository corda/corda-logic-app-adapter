{
  "definitions": {},
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://bitbucket.org/mplattr3/corda-logicapp-format/src/master/flow-invocation-response.schema.json",
  "type": "object",
  "title": "Flow Invocation Response Schema",
  "description": "This is the format messages emitted as a result of a flow invocation.",
  "required": [
    "messageName",
    "additionalInformation",
    "contractLedgerIdentifier",
    "contractProperties",
    "messageSchemaVersion",
    "isNewContract"
  ],
  "properties": {
    "messageName": {
      "$id": "#/properties/messageName",
      "type": "string",
      "enum": [
        "ContractMessage"
      ]
    },
    "additionalInformation": {
      "$id": "#/properties/additionalInformation",
      "type": "object",
      "description": "Corda-specific information in response to the flow invocation.",
      "required": [
        "outputStates"
      ],
      "properties": {
        "outputStates": {
          "$id": "#/properties/additionalInformation/properties/outputStates",
          "type": "array",
          "description": "The linear output states generated by the flow invocation. This will not include any states that are non-linear.",
          "items": {
            "$id": "#/properties/additionalInformation/properties/outputStates/items",
            "type": "object",
            "required": [
              "name",
              "id",
              "isNewState"
            ],
            "properties": {
              "name": {
                "$id": "#/properties/additionalInformation/properties/outputStates/items/properties/name",
                "type": "string",
                "description": "The type of the output state as a fully qualified class name.",
                "default": "",
                "examples": [
                  "net.corda.workbench.refrigeratedTransportation.Shipment"
                ],
                "pattern": "(?:^\\w+|\\w+\\.\\w+)+$"
              },
              "id": {
                "$id": "#/properties/additionalInformation/properties/outputStates/items/properties/id",
                "type": "string",
                "description": "The linear ID of this state.",
                "default": "",
                "examples": [
                  "130ff635-355a-45fa-a8aa-f2f8a574c8ca"
                ]
              },
              "isNewState": {
                "$id": "#/properties/additionalInformation/properties/outputStates/items/properties/isNewState",
                "type": "boolean",
                "description": "Whether this state in \"new\" in the terminology of Workbench, i.e. if that state resulted of a transaction with another input state."
              }
            }
          }
        }
      }
    },
    "contractLedgerIdentifier": {
      "$id": "#/properties/contractLedgerIdentifier",
      "type": "string",
      "description": "The Corda \"FlowHandle\" that is a result of this flow invocation.",
      "pattern": "\\b[0-9a-f]{8}\\b-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-\\b[0-9a-f]{12}\\b"
    },
    "parameters": {
      "$id": "#/properties/contractProperties",
      "type": "array",
      "description": "The return value  of the flow as generated by a standard output mapper. This means this format is directly controlled by the Corda developer.",
      "items": {
        "$id": "#/properties/contractProperties/items",
        "type": "object",
        "required": [
          "name",
          "value"
        ],
        "properties": {
          "name": {
            "$id": "#/properties/contractProperties/items/properties/name",
            "type": "string"
          },
          "value": {
            "$id": "#/properties/contractProperties/items/properties/value",
            "type": "string"
          }
        }
      }
    },
    "messageSchemaVersion": {
      "$id": "#/properties/messageSchemaVersion",
      "type": "string",
      "default": "1.0.0",
      "pattern": "^\\d+\\.\\d+\\.\\d+$"
    },
    "isNewContract": {
      "$id": "#/properties/isNewContract",
      "type": "boolean",
      "description": "Whether this flow invocation represents a \"new contract\" in the terminology of Workbench. A contract is considered \"new\" if no input states have been consumed as a result of this flow invocation."
    }
  }
}